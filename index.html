<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio and Image to Video Converter</title>
    <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.11.6/dist/ffmpeg.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #121212;
            color: #e0e0e0;
        }
        .input-group {
            margin-bottom: 15px;
        }
        #status, #downloadLink, #progressBar {
            margin-top: 20px;
        }<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio and Image to Video Converter</title>
    <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.9.8/dist/ffmpeg.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #121212;
            color: #e0e0e0;
        }
        .input-group {
            margin-bottom: 15px;
        }
        #status, #downloadLink {
            margin-top: 20px;
        }
        .error {
            color: #ff6b6b;
        }
        button {
            background-color: #bb86fc;
            color: #000;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #3700b3;
            color: #fff;
        }
        button:disabled {
            background-color: #4a4a4a;
            cursor: not-allowed;
        }
        a {
            color: #03dac6;
        }
        #status {
            white-space: pre-line;
        }
    </style>
</head>
<body>
    <h1>Audio and Image to Video Converter</h1>
    
    <div class="input-group">
        <label for="imageInput">Select an image:</label>
        <input type="file" id="imageInput" accept="image/*">
    </div>

    <div class="input-group">
        <label for="audioInput">Select an audio file:</label>
        <input type="file" id="audioInput" accept="audio/*">
    </div>

    <button id="convertBtn">Convert</button>

    <div id="status"></div>
    <div id="downloadLink"></div>

    <script>
        const { createFFmpeg, fetchFile } = FFmpeg;
        const ffmpeg = createFFmpeg({ log: true });

        let imageFile, audioFile;
        const convertBtn = document.getElementById('convertBtn');

        document.getElementById('imageInput').addEventListener('change', (e) => {
            imageFile = e.target.files[0];
        });

        document.getElementById('audioInput').addEventListener('change', (e) => {
            audioFile = e.target.files[0];
        });

        convertBtn.addEventListener('click', convertToVideo);

        function updateStatus(message) {
            const statusElement = document.getElementById('status');
            statusElement.textContent += message + '\n';
            console.log(message);
        }

        async function convertToVideo() {
            const statusElement = document.getElementById('status');
            const downloadLinkElement = document.getElementById('downloadLink');
            
            statusElement.textContent = '';
            convertBtn.disabled = true;
            
            try {
                if (!imageFile || !audioFile) {
                    throw new Error('Please select both an image and an audio file');
                }

                updateStatus('Loading FFmpeg...');
                await ffmpeg.load();
                updateStatus('FFmpeg loaded successfully.');

                updateStatus('Writing image file...');
                ffmpeg.FS('writeFile', 'image.jpg', await fetchFile(imageFile));
                updateStatus('Image file written successfully.');

                updateStatus('Writing audio file...');
                ffmpeg.FS('writeFile', 'audio.mp3', await fetchFile(audioFile));
                updateStatus('Audio file written successfully.');

                updateStatus('Starting FFmpeg conversion...');
                await ffmpeg.run(
                    '-loop', '1', 
                    '-i', 'image.jpg', 
                    '-i', 'audio.mp3', 
                    '-c:v', 'libx264', 
                    '-tune', 'stillimage', 
                    '-c:a', 'aac', 
                    '-b:a', '192k', 
                    '-pix_fmt', 'yuv420p', 
                    '-shortest', 
                    'output.mp4'
                );
                updateStatus('FFmpeg conversion completed.');

                updateStatus('Reading output file...');
                const data = ffmpeg.FS('readFile', 'output.mp4');
                const video = new Blob([data.buffer], { type: 'video/mp4' });
                const url = URL.createObjectURL(video);
                downloadLinkElement.innerHTML = `<a href="${url}" download="video.mp4">Download video</a>`;
                updateStatus('Conversion completed successfully!');

            } catch (error) {
                console.error('Conversion error:', error);
                statusElement.innerHTML += `<span class="error">Error: ${error.message}</span>\n`;
                statusElement.innerHTML += 'Please check the console for more details.\n';
            } finally {
                convertBtn.disabled = false;
            }
        }
    </script>
</body>
</html>
        .error {
            color: #ff6b6b;
        }
        button {
            background-color: #bb86fc;
            color: #000;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #3700b3;
            color: #fff;
        }
        button:disabled {
            background-color: #4a4a4a;
            cursor: not-allowed;
        }
        a {
            color: #03dac6;
        }
        #status {
            white-space: pre-line;
        }
        #progressBar {
            width: 100%;
            background-color: #f0f0f0;
        }
        #progressBar div {
            height: 30px;
            background-color: #4CAF50;
            text-align: center;
            line-height: 30px;
            color: white;
        }
    </style>
</head>
<body>
    <h1>Audio and Image to Video Converter</h1>
    
    <div class="input-group">
        <label for="imageInput">Select an image:</label>
        <input type="file" id="imageInput" accept="image/*">
    </div>

    <div class="input-group">
        <label for="audioInput">Select an audio file:</label>
        <input type="file" id="audioInput" accept="audio/*">
    </div>

    <button id="convertBtn">Convert</button>

    <div id="status"></div>
    <div id="progressBar"><div></div></div>
    <div id="downloadLink"></div>

    <script>
        const { createFFmpeg, fetchFile } = FFmpeg;
        const ffmpeg = createFFmpeg({ 
            log: true,
            progress: ({ ratio }) => {
                const percent = (ratio * 100).toFixed(2);
                document.getElementById('progressBar').children[0].style.width = `${percent}%`;
                document.getElementById('progressBar').children[0].textContent = `${percent}%`;
            }
        });

        let imageFile, audioFile;
        const convertBtn = document.getElementById('convertBtn');

        document.getElementById('imageInput').addEventListener('change', (e) => {
            imageFile = e.target.files[0];
        });

        document.getElementById('audioInput').addEventListener('change', (e) => {
            audioFile = e.target.files[0];
        });

        convertBtn.addEventListener('click', convertToVideo);

        function updateStatus(message) {
            const statusElement = document.getElementById('status');
            statusElement.textContent += message + '\n';
            console.log(message);
        }

        async function convertToVideo() {
            const statusElement = document.getElementById('status');
            const downloadLinkElement = document.getElementById('downloadLink');
            const progressBarElement = document.getElementById('progressBar');
            
            statusElement.textContent = '';
            downloadLinkElement.innerHTML = '';
            progressBarElement.children[0].style.width = '0%';
            progressBarElement.children[0].textContent = '';
            convertBtn.disabled = true;
            
            try {
                if (!imageFile || !audioFile) {
                    throw new Error('Please select both an image and an audio file');
                }

                updateStatus('Loading FFmpeg...');
                await ffmpeg.load();
                updateStatus('FFmpeg loaded successfully.');

                updateStatus('Writing image file...');
                await ffmpeg.FS('writeFile', 'image.jpg', await fetchFile(imageFile));
                updateStatus('Image file written successfully.');

                updateStatus('Writing audio file...');
                await ffmpeg.FS('writeFile', 'audio.mp3', await fetchFile(audioFile));
                updateStatus('Audio file written successfully.');

                updateStatus('Starting FFmpeg conversion...');
                await ffmpeg.run(
                    '-loop', '1', 
                    '-i', 'image.jpg', 
                    '-i', 'audio.mp3', 
                    '-c:v', 'libx264', 
                    '-tune', 'stillimage', 
                    '-c:a', 'aac', 
                    '-b:a', '192k', 
                    '-pix_fmt', 'yuv420p', 
                    '-shortest', 
                    'output.mp4'
                );
                updateStatus('FFmpeg conversion completed.');

                updateStatus('Reading output file...');
                const data = await ffmpeg.FS('readFile', 'output.mp4');
                const video = new Blob([data.buffer], { type: 'video/mp4' });
                const url = URL.createObjectURL(video);
                downloadLinkElement.innerHTML = `<a href="${url}" download="video.mp4">Download video</a>`;
                updateStatus('Conversion completed successfully!');

            } catch (error) {
                console.error('Conversion error:', error);
                statusElement.innerHTML += `<span class="error">Error: ${error.message}</span>\n`;
                statusElement.innerHTML += 'Please check the console for more details.\n';
            } finally {
                convertBtn.disabled = false;
            }
        }
    </script>
</body>
</html>
